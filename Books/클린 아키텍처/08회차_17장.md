# 17장, 경계, 선 긋기

### 요약
* 아키텍처의 목적 -> 시스템을 만들고 유지하는데 비용을 줄이기
    * 이것을 위반하는것 -> 너무 이른 결정

* 너무 일른 결정에는 위험이 따른다.
* 이른 결정이란?
    * 시스템의 업무 요구사항과 관련 없는 결정
        * 프레임워크
        * 데이터베이스
        * 웹 서비스
        * 유틸리티 라이브러리
        * 의존성 주입

### 두가지 슬픈 이야기
* 잘나가는 GUI 애플리케이션의 웹 기반 버전을 만들며 생기게 된 상황
* 프로그래머들이 서버팜을 꿈꾸고 서버를 여러 단계로 쪼개게 됨
* ![서버팜](https://docs.microsoft.com/ko-kr/aspnet/web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework/_static/image1.png)
* 하지만 단일 서버로 운영하게 됨 -> 개발 비용 매우 증가

* 해결방법 : 너무 크게 잡지말자, 대신 인터페이스등으로 언제든 확장가능하게 개발하기?

### FitNesse
* 위키 페이지를 개발하려함
* 웹 서버 프레임워크를 사용하지 않고 직접 구현후 나중에 결정하기로 함
* 데이터베이스에 대한 고민을 늦추고 어떤 데이터베이스도 붙일수있는 형태로 개발함
* 결정을 늦춤으로써 시간을 매우 절약하고 테스트를 빠르게 돌렸다.


```csharp
public static Action<Action> ShowPopupIDFA; //idfa팝업을 보여줄때 불러주세요

private void Init()
{
    ShowPopupIDFA = PopupIDFA.Instance.Show;
}
```

### 어떻게 선을 그을까? 그리고 언제 그을까?

* 데이터베이스같은 경우는 인터페이스를 만들어 자세한 결정을 뒤로 미룰수있다.
* 경계선은 인터페이스와 인터페이스 뒤에 있는 실존 클래스의 사이에 존재
* 경계선을 그어 단방향으로 통신해라, 뒤에서 공급하는 클래스는 앞을 알지 못하게
    * 앞에서 나온 내용과 중복

### 입력과 출력은?
* 입력과 출력은 중요하지 않다.
* 게임의 예시에서 (인터페이스와 인터페이스를 조작하는 모델)
    * 모델은 인터페이스를 전혀 필요로 하지 않는다.
    * 인터페이스는 모델에게 있어 중요하지 않다, 중요한건 업무 규칙이다.

```csharp

interface Unit
{
    void Jump();
}

...
private void Update()
{
    if (Input.GetKeyDown(KeyCode.Space))
        playerUnit.Jump();
}
```


### 플러그인 아키텍처
* 데이터베이스 , 사용자 인터페이스를 플러그인으로 사용해 어떤 종류든지 대체할수있음
* 하지만 새로운 플러그인으로 교체할경우 통신 일부는 재작업해야 할 수도 있음 -> 그래도 최소한 현실성있게 변경가능

### 플러그인에 대한 논의
* ReSharper와 비주얼 스튜디오의 관계
    * 의존성에 의해 ReSharper팀은 비주얼 스튜디오 팀을 건드릴 수 없다.
    * 하지만 비주얼 스튜디오는 ReSharper를 언제든 무력화할 수 있다.
    * ReSharper팀이 비주얼 스튜디오 소스코드를 의존하기 때문.




